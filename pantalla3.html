<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Art√≠culos agregados - Zapata</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #00416A, #E4E5E6);
      margin: 0;
      padding: 20px;
      color: white;
      min-height: 100vh;
      position: relative;
      box-sizing: border-box;
    }

    .marca-agua {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 0.20;
      max-width: 80%;
      pointer-events: none;
      z-index: 0;
    }

    .contenedor {
      max-width: 800px;
      margin: auto;
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
      z-index: 2;
      position: relative;
    }

    h2 {
      margin-bottom: 20px;
      font-size: 24px;
      text-align: center;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      background: white;
      color: black;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      font-size: 16px;
    }

    button {
      padding: 10px 16px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-right: 10px;
    }

    .editar { background: #f57c00; color: white; }
    .eliminar { background: #9e9e9e; color: white; }

    .boton-grande {
      width: 100%;
      margin-top: 15px;
      padding: 14px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      border: none;
      font-weight: bold;
    }

    .agregar {
      background: #d32f2f;
      color: white;
    }

    .finalizar {
      background: #388e3c;
      color: white;
    }

    footer {
      text-align: center;
      margin-top: 30px;
      font-size: 14px;
      color: rgba(255,255,255,0.7);
    }
  </style>
</head>

<body>

<img src="logo_proveedora.png" class="marca-agua">

<div class="contenedor">
  <h2>üßæ Art√≠culos agregados</h2>

  <ul id="listaEditable"></ul>

  <button class="boton-grande agregar" onclick="window.location.href='pantalla2.html'">‚ûï Agregar m√°s productos</button>
  <button class="boton-grande finalizar" onclick="finalizar()">‚úÖ Finalizar y Firmar</button>
</div>

<footer>
  ¬© 2025 Proveedora de Desechables Zapata ¬∑ Sistema de Inventario ¬∑ Desarrollado por Adm Sistemas
</footer>

<script>
let listaTemporal = JSON.parse(localStorage.getItem("carrito")) || [];

// Mostrar lista editable
function actualizarListaEditable() {
  const ul = document.getElementById("listaEditable");
  ul.innerHTML = "";

  if (listaTemporal.length === 0) {
    ul.innerHTML = "<li>No hay productos agregados.</li>";
    return;
  }

  listaTemporal.forEach((item, index) => {
    const li = document.createElement("li");
    li.innerHTML = `
      <strong>‚Ä¢ ${item.cantidad} x ${item.nombre}</strong>
      <br><small>C√≥digo: ${item.codigo}</small><br><br>
      <button class="editar" onclick="editarCantidad(${index})">‚úèÔ∏è Editar</button>
      <button class="eliminar" onclick="eliminarProducto(${index})">üóëÔ∏è Eliminar</button>
    `;
    ul.appendChild(li);
  });
}

// Editar cantidad
function editarCantidad(index) {
  const nuevaCantidad = prompt("Nueva cantidad:", listaTemporal[index].cantidad);

  if (nuevaCantidad !== null && !isNaN(nuevaCantidad) && parseInt(nuevaCantidad) > 0) {
    listaTemporal[index].cantidad = parseInt(nuevaCantidad);
    guardarLista();
    actualizarListaEditable();
  } else {
    alert("Cantidad inv√°lida.");
  }
}

// Eliminar producto
function eliminarProducto(index) {
  if (confirm("¬øEliminar este producto?")) {
    listaTemporal.splice(index, 1);
    guardarLista();
    actualizarListaEditable();
  }
}

function guardarLista() {
  localStorage.setItem("carrito", JSON.stringify(listaTemporal));
}

// Continuar a firma
function finalizar() {
  const fecha = localStorage.getItem("fecha");
  const entrega = localStorage.getItem("entrega");
  const recibe = localStorage.getItem("recibe");

  localStorage.setItem("resumenFecha", fecha);
  localStorage.setItem("resumenEntrega", entrega);
  localStorage.setItem("resumenRecibe", recibe);

  window.location.href = "pantalla4.html";
}

actualizarListaEditable();
</script>

</body>
</html>
